<p style="color: green"><%= notice %></p>

<% content_for :title, "Texts" %>

<div class="px-4 py-12 mx-auto max-w-7xl sm:px-6 lg:px-8">
  <div class="flex flex-col justify-between items-center mb-8 sm:flex-row">
    <h1 class="text-4xl font-bold text-center text-gray-800 sm:text-left">Texts Collection</h1>

    <%= link_to new_text_path, class: "inline-flex items-center px-6 py-3 mt-4 sm:mt-0 text-base font-medium text-white bg-gradient-to-r from-green-600 to-green-700 rounded-lg shadow-sm hover:from-green-700 hover:to-green-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors duration-300" do %>
    <svg xmlns="http://www.w3.org/2000/svg" class="mr-2 w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
    </svg>
    Add New Text
    <% end %>
  </div>

  <!-- Barre de filtres -->
  <div class="filters-container" 
       data-controller="filters"
       data-filters-clear-url-value="<%= texts_path %>"
       data-filters-has-active-filters-value="<%= (@selected_school_ids.any? || @selected_deity_ids.any? || @selected_tag_ids.any?).to_s %>">
    <!-- Bouton toggle des filtres -->
    <button class="filters-toggle-button"
            data-filters-target="toggleButton"
            data-action="click->filters#toggleFilters">
      <svg id="filterIcon" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z" />
      </svg>
      <span data-filters-target="filterText">Show Filters</span>
      <svg data-filters-target="chevronDown" class="filters-toggle-chevron" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
      </svg>
    </button>

    <!-- Section des filtres -->
    <div class="filters-section" 
         data-filters-target="filtersSection">
      <%= form_with url: texts_path, method: :get, local: true do |form| %>
        <div class="filters-grid">
          <!-- Filtre par Schools -->
          <div class="filter-group">
            <h4>Schools</h4>
            <div class="filter-pills-container">
              <%= form.collection_check_boxes :school_ids, @schools, :id, :name, { checked: @selected_school_ids } do |b| %>
                <label class="pill-filter" 
                       data-category="school"
                       data-action="click->filters#togglePill">
                  <%= b.check_box(class: "pill-checkbox") %>
                  <span class="pill-content">
                    <%= b.text %>
                  </span>
                </label>
              <% end %>
            </div>
          </div>
          
          <!-- Filtre par Deities -->
          <div class="filter-group">
            <h4>Deities</h4>
            <div class="filter-pills-container">
              <%= form.collection_check_boxes :deity_ids, @deities, :id, :name_english, { checked: @selected_deity_ids } do |b| %>
                <label class="pill-filter" 
                       data-category="deity"
                       data-action="click->filters#togglePill">
                  <%= b.check_box(class: "pill-checkbox") %>
                  <span class="pill-content">
                    <%= b.text %>
                  </span>
                </label>
              <% end %>
            </div>
          </div>
          
          <!-- Filtre par Tags -->
          <div class="filter-group">
            <h4>Tags</h4>
            <div class="filter-pills-container">
              <%= form.collection_check_boxes :tag_ids, @tags, :id, :name, { checked: @selected_tag_ids } do |b| %>
                <label class="pill-filter" 
                       data-category="tag"
                       data-action="click->filters#togglePill">
                  <%= b.check_box(class: "pill-checkbox") %>
                  <span class="pill-content">
                    <%= b.text %>
                  </span>
                </label>
              <% end %>
            </div>
          </div>
        </div>
        
        <div class="filter-actions">
          <%= form.submit "Apply Filters", class: "apply-filters-button" %>
          <button type="button" 
                  class="clear-filters-button"
                  data-filters-target="clearButton"
                  data-action="click->filters#clearFilters">
            Clear Filters
          </button>
        </div>
      <% end %>
    </div>
  </div>

  <div class="grid grid-cols-1 gap-8 sm:grid-cols-2 lg:grid-cols-3">
    <% @texts.each do |text| %>
      <%= link_to text_translations_path(text) do %>
        <%= render text %>
      <% end %>
    <% end %>
  </div>
</div>





